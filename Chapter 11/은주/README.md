# 11장. 자주 쓰는 서버 구조와 설계 패턴

## DDD와 전술 패턴
- 애그리거트 : 모델의 일관성을 관리하는 단위
- 도메인 서비스 : 특정 애그리거트에 속하지 않은 로직 구현. 외부 연동 필요한 도메인 로직도 이 곳에서 표현
  - 계산 로직: 여러 애그리거트가 필요한 계산 로직이나 한 애그리거트에 넣기에는 다소 복잡한 계산 로직
  - 외부 시스템 연동: 구현하기 위해 타 시스템을 사용해야 하는 도메인 로직

### 마이크로서비스 아키텍처
- 마이크로서비스는 비용을 들여 기술, 확장, 견고함과 같은 유연함을 얻는 구조

### CQRS 패턴
- 상태 변경에 사용하는 데이터, 상태 조회 시 사용하는 데이터에 차이가 있을 수 있다
- 명령과 조회가 서로 다른 데이터를 사용하는데, 하나의 모델로 명령/조회를 모두 구현할 경우 모델이 복잡해지고 코드 유지보수가 어려워진다.
  - CQRS (Command Query Responsibility Segregation) 명령을 위한 모델, 조회를 위한 모델을 분리하는 패턴을 사용해서 **단일 모델 사용으로 인해 발생하는 복잡도 문제 해결 가능**
- 조회 모델이 별도로 존재하므로 조회 성능 향상이 쉽다 (캐시 적용, 조회 전용 DB 확장)
- 각 기능마다 모델을 따로 만들어야 하므로 작업할 코드가 늘어나는 단점도 있다
- 조회 모델의 경우 높은 트래픽 처리를 위해 별도 조회 전용 DB 에 구축하는 경우도 있음
  - 메시지 큐나 이벤트 소싱을 사용하여 **명령 데이터베이스와 조회 데이터베이스 간의 데이터를 동기화해야 함**