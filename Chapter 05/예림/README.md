# 5장. 비동기 연동, 언제 어떻게 써야 할까

## 동기 연동과 비동기 연동
- 동기 연동 시 고려할 점
    - 외부 연동 실패가 전체 기능의 실패인지 고려
        - 로그인 후 포인트 지급 실패 시 로그인에도 실패하게 되어 있다면 기록을 남기는 방식으로 코드 작성
    - 외부 서비스의 응답 시간
      - 연동 서비스의 응답 시간 ⬆️ -> 응답 시간 ⬆️
      - 반드시 외부 연동 결과가 필요한 게 아니라면 비동기 방식 연동 고려
          - 포인트 지급이 끝날 때까지 기다리지 않고 로그인 성공 응답


- 비동기 사용 시 문제가 되지 않는 경우
  - 연동에 약간의 시차가 생겨도 문제가 되지 않음
  - 일부 기능은 실패 시 재시도 가능
  - 연동 실패 시 나중에 수동으로 처리 가능
  - 연동에 실패해도 무시해도 됨
- 예시
  - 푸시 서비스
  - 포인트 서비스
  - 검색 서비스 (컨텐츠 등록 시 검색 서비스에도 등록)
  - SMS 발송 서비스 연동 (인증 번호 요청 시 SMS로 인증 메시지 발송)
## 별도 스레드로 실행하기
- 비동기 연동을 하는 가장 쉬운 방법? 별도 스레드로 실행하기
- 스레드를 생성하거나, 스레드 풀을 사용하거나 스프링이 제공하는 @Async 이용

  - @Async 사용 시 메서드 이름에 비동기 메서드임을 알 수 있도록 async를 넣는 게 좋음
- 비동기로 실행되는 코드는 연동 과정에서 발생하는 오류를 직접 처리해야 한다.
## 메시징
- 서로 다른 시스템 간 비동기로 연동할 때 주로 사용하는 방식은 메시징 시스템을 사용하는 것
- 직접 호출하는 것보다 좋은 점
  - 두 시스템이 서로 영향을 주지 않음